/*
 * This file was generated by the Gradle 'init' task.
 */

buildscript {
    ext {
        PUBLISH_GROUP_ID = 'io.hanko'
        PUBLISH_ARTIFACT_ID = 'java-sdk'
    }
}

plugins {
    id 'java'
    id 'maven-publish'
    id 'com.jfrog.bintray' version '1.8.5'
}

apply plugin: 'java-library'
apply plugin: 'maven-publish'

repositories {
    mavenLocal()
    maven {
        url = uri('https://repo.maven.apache.org/maven2')
    }
}

dependencies {
    implementation 'org.apache.httpcomponents:httpclient:4.5.12'
    implementation 'com.fasterxml.jackson.core:jackson-core:2.11.1'
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.11.1'
    implementation 'org.slf4j:slf4j-api:1.7.30'
}

def projectDisplayName = "HANKO Java SDK"
project.version = System.getenv('CI_COMMIT_TAG') ?: "1.0.0-SNAPSHOT"
println(project.version)
group = "io.hanko"
sourceCompatibility = '1.8'

tasks.register("sourcesJar", Jar) {
    from sourceSets.main.allJava
    classifier "sources"
}

tasks.register("javadocJar", Jar) {
    from javadoc
    classifier "javadoc"
}

publishing {
    publications {
        Publication(MavenPublication) {
            from(components.java)

            artifact sourcesJar
            artifact javadocJar

            groupId "$PUBLISH_GROUP_ID"
            artifactId "$PUBLISH_ARTIFACT_ID"
            version project.version
        }
    }
}

bintray {
    user = System.getenv("BINTRAY_USER")
    key = System.getenv("BINTRAY_KEY")

    publications = ['Publication']
    pkg {
        repo = 'jvm-sdks'
        name = 'java'
        userOrg = 'hanko'
        licenses = ['Apache-2.0']
        vcsUrl = 'https://github.com/teamhanko/hanko-sdk-java'
        publish = true
        version {
            name = project.version
            desc = "${projectDisplayName}: ${project.version}"
            released = new Date()
            vcsTag = project.version
        }
    }
}
